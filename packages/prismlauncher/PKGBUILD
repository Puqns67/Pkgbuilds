# Maintainer: Puqns67 <me@puqns67.icu>

_pkgname='PrismLauncher'

pkgname='prismlauncher'
pkgver=9.1
pkgrel=1
pkgdesc='Minecraft launcher with ability to manage multiple instances.'
arch=('x86_64' 'aarch64')
url='https://prismlauncher.org/'
license=('GPL-3.0-only')
depends=('bzip2' 'cmark' 'gcc-libs' 'glibc' 'hicolor-icon-theme' 'libglvnd' 'qt6-5compat' 'qt6-base' 'qt6-networkauth' 'quazip-qt6' 'tomlplusplus' 'zlib')
makedepends=('cmake' 'extra-cmake-modules' 'gamemode' 'ghc-filesystem' 'java-environment=17' 'ninja' 'scdoc')
optdepends=('flite: for Minecraft text2speech support'
            'glfw: to use system GLFW libraries'
            'openal: to use system OpenAL libraries'
            'visualvm: Profiling support'
            'mangohud: run Minecraft with mangohud'
            'gamemode: run Minecraft with gamemode'
            'xorg-xrandr: for older Minecraft (<=1.12.2)'
            'java-runtime=8: for older Minecraft (<1.18 Pre-release 2)'
            'java-runtime=17: for Minecraft 1.18.0+ (>=1.18 Pre-release 2)'
            'java-runtime=21: for Minecraft 1.20.5+ (>=24w14a)'
            'qt6-wayland: for Wayland support')

source=("${pkgname}-${pkgver}.tar.gz"::"https://github.com/PrismLauncher/PrismLauncher/releases/download/${pkgver}/${_pkgname}-${pkgver}.tar.gz")

b2sums=('1bb31dab88d9ca4317e61b6938f9b5aeb0b76cab3407d69b62ecf9bfa1ade3308a8927f53e020b6531fbe0cce962c7e560727298a911f07b9fec1f51b1470cd9')

prepare() {
  cmake \
    -B "${srcdir}/build" \
    -D CMAKE_BUILD_TYPE=RelWithDebInfo \
    -D CMAKE_INSTALL_PREFIX=/usr \
    -D BUILD_TESTING=OFF \
    -D ENABLE_LTO=ON \
    -D Launcher_BUILD_PLATFORM=archlinux \
    -G Ninja \
    -S "${srcdir}/${_pkgname}-${pkgver}"
}

build() {
  cmake --build "${srcdir}/build"
}

package() {
  DESTDIR="${pkgdir}" cmake --install "${srcdir}/build"
}
